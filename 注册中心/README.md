
* [注册中⼼](#注册中⼼)



---

## 注册中⼼

    有了服务的接⼝描述，下⼀步要解决的问题就是服务的发布和订阅，就是说你提供了⼀个服务，如何让外部想调⽤你的服务的⼈知道。这个时候就需要⼀个类似注册中
    ⼼的⻆⾊，服务提供者将⾃⼰提供的服务以及地址登记到注册中⼼，服务消费者则从注册中⼼查询所需要调⽤的服务的地址，然后发起请求。⼀般来讲，
    
    注册中⼼原理

    在微服务架构下，主要有三种⻆⾊：服务提供者（RPC Server）、服务消费者（RPC Client）和服务注册中⼼（Registry），三者的交互关系请看下⾯这张图
    ，我来简单解释⼀下。
    
<a href="https://ibb.co/hHFB92C"><img src="https://i.ibb.co/5vhr4s2/05-17-12.png" alt="05-17-12" border="0"></a>    
    
    
    RPC Server提供服务，在启动时，根据服务发布⽂件server.xml中的配置的信息，向Registry注册⾃身服务，并向Registry定期发送⼼跳汇报存活状态。
    
    RPC Client调⽤服务，在启动时，根据服务引⽤⽂件client.xml中配置的信息，向Registry订阅服务，把Registry返回的服务节点列表缓存在本地内存中，并与
    RPC Sever建⽴连接。
    
    当RPC Server节点发⽣变更时，Registry会同步变更，RPC Client感知后会刷新本地内存中缓存的服务节点列表。
    
    RPC Client从本地缓存的服务节点列表中，基于负载均衡算法选择⼀台RPC Sever发起调⽤。
    
    
 ## 注册中⼼实现⽅式   

注册中⼼的实现主要涉及⼏个问题：[注册中⼼需要提供哪些接⼝](#注册中⼼API接口)，该如何部署；如何存储服务信息；如何监控服务提供者节点
的存活；如果服务提供者节点有变化如何通知服务消费者，以及如何控制注册中⼼的访问权限

### 注册中⼼API接口

    1. 服务注册接⼝：服务提供者通过调⽤服务注册接⼝来完成服务注册。
    2. 服务反注册接⼝：服务提供者通过调⽤服务反注册接⼝来完成服务注销。
    3. ⼼跳汇报接⼝：服务提供者通过调⽤⼼跳汇报接⼝完成节点存活状态上报。
    4. 服务订阅接⼝：服务消费者通过调⽤服务订阅接⼝完成服务订阅，获取可⽤的服务提供者节点列表。
    5. 服务变更查询接⼝：服务消费者通过调⽤服务变更查询接⼝，获取最新的可⽤服务节点列表。
    6. 服务查询接⼝：查询注册中⼼当前注册了哪些服务信息。
    7. 服务修改接⼝：修改注册中⼼中某⼀服务的信息。
### 
