 [15种微服务架构框架汇总](http://dockerone.com/article/9892)|
 ---|

* [服务框架](#服务框架)
* [RPC远程服务调⽤原理]()
  * [通信框架](#通信框架)
    * [客户端和服务端如何建⽴⽹络连接](#客户端和服务端如何建⽴⽹络连接)
      * [HTTP通信](#HTTP通信)
      * [Socket通信](#Socket通信)
    * [服务端如何处理请求？](#服务端如何处理请求？)
      * [同步阻塞⽅式（BIO）](#同步阻塞⽅式)
      * [同步⾮阻塞⽅式 (NIO)](#同步⾮阻塞⽅式)
      * [异步⾮阻塞⽅式（AIO）](#异步⾮阻塞⽅式)
    * 通信框架选型
      * [Netty](#Netty)
  * [通信胁议](#通信胁议)
    * [数据传输采⽤什么协议](#数据传输采⽤什么协议)
      * 开放的协议
        * [HTTP数据传输协议](#HTTP数据传输协议)
      * 私有的协议
        * [Dubbo数据传输协议](#Dubbo数据传输协议)
  * [序列化和反序列化](#序列化和反序列化)
    * [数据该如何序列化和反序列化](#数据该如何序列化和反序列化)
      * [⽂本类---XML/JSON](#⽂本类如XMLJSON等)
      * [⼆进制类---PB/Thrift](#⼆进制类如PBThrift)
    * [ 数据压缩采⽤什么格式](#数据压缩采⽤什么格式)
  * [RPC框架如何选型](#RPC框架如何选型)
    * 跟某种特定语⾔平台绑定的
      * Dubbo---仅支持JAVA
      * Montan---仅支持JAVA
      * Tars---仅支持C++
      * Spring Cloud---仅支持JAVA
    * 跨语⾔平台
      * [gRPC---Google于2015年对外开源的跨语⾔RPC框架，⽀持常⽤的C++、Java、Python、Go、Ruby、PHP、Android
Java、Objective-C等多种语⾔](#gRPC)
      * [Thrift---由Facebook开发的内部系统跨语⾔的RPC框架](#Thrift)
---


## 服务框架

    
    在单体应⽤时，⼀次服务调⽤发⽣在同⼀台机器上的同⼀个进程内部，也就是说调⽤发⽣在本机内部，因此也被叫作本地⽅法调⽤。在进⾏服务化拆分之后，服务提
    供者和服务消费者运⾏在两台不同物理机上的不同进程内，它们之间的调⽤相⽐于本地⽅法调⽤，可称之为远程⽅法调⽤，简称RPC（Remote Procedure Call），
    那么RPC调⽤是如何实现的呢？
    
    我习惯把服务消费者叫作客户端，服务提供者叫作服务端，两者通常位于⽹络上两个不同的地址，要完成⼀次RPC调⽤，就必须先建⽴⽹络连接。建⽴连接后，双⽅
    还必须按照某种约定的协议进⾏⽹络通信，这个协议就是通信协议。双⽅能够正常通信后，服务端接收到请求时，需要以某种⽅式进⾏处理，处理成功后，把请求
    结果返回给客户端。为了减少传输的数据⼤⼩，还要对数据进⾏压缩，也就是对数据进⾏序列化。
    
    上⾯就是RPC调⽤的过程，由此可⻅，想要完成调⽤，你需要解决几个问题：
    
    通信框架: 它主要解决客户端和服务端如何建⽴连接、管理连接以及服务端如何处理请求的问题。
    
    通信协议: 它主要解决客户端和服务端采⽤哪种数据传输协议的问题。
    
    序列化和反序列化:它主要解决客户端和服务端采⽤哪种数据编解码的问题。
    
    这三个部分就组成了⼀个完整的RPC调⽤框架
    
    通信框架提供了基础的通信能⼒，通信协议描述了通信契约，⽽序列化和反序列化则⽤于数据的编/解码。⼀个通信框架可以适配多种通信协议，也可以采⽤多种
    序列化和反序列化的格式，⽐如服务化框架Dubbo不仅⽀持Dubbo协议，还⽀持RMI协议、HTTP协议等，⽽且还⽀持多种序列化和反序列化格式，⽐如JSON、
    Hession 2.0以及Java序列化等。

## 通信框架
### 客户端和服务端如何建⽴⽹络连接

       就是说服务提供者和服务消费者之间以什么样的协议进⾏⽹络通信，是采⽤四层TCP、UDP协议，还是采⽤七层HTTP协议，还是采⽤其他协议？

客户端和服务端之间基于TCP协议建⽴⽹络连接最常⽤的途径有两种    

#### HTTP通信

     HTTP通信是基于应⽤层HTTP协议的，⽽HTTP协议⼜是基于传输层TCP协议的。⼀次HTTP通信过程就是发起⼀次HTTP调⽤，⽽⼀次HTTP调⽤就会建⽴⼀个TCP连
     接，经历⼀次下图所示的“三次握⼿”的过程来建⽴连接。
     
#### Socket通信

     Socket通信是基于TCP/IP协议的封装，建⽴⼀次Socket连接⾄少需要⼀对套接字，其中⼀个运⾏于客户端，称为ClientSocket；另⼀个运⾏于服务器端，称
     为ServerSocket 。就像下图所描述的，Socket通信的过程分为四个步骤：服务器监听、客户端请求、连接确认、数据传输。
     
     服务器监听：ServerSocket通过调⽤bind()函数绑定某个具体端⼝，然后调⽤listen()函数实时监控⽹络状态，等待客户端的连接请求。

     客户端请求：ClientSocket调⽤connect()函数向ServerSocket绑定的地址和端⼝发起连接请求。
     
     服务端连接确认：当ServerSocket监听到或者接收到ClientSocket的连接请求时，调⽤accept()函数响应ClientSocket的请求，同客户端建⽴连接。

     数据传输：当ClientSocket和ServerSocket建⽴连接后，ClientSocket调⽤send()函数，ServerSocket调⽤receive()函数，ServerSocket处理完请求后，
     调⽤send()函数，ClientSocket调⽤receive()函数，就可以得到得到返回结果。

### 服务端如何处理请求

    端和服务端已经建⽴了⽹络连接，服务端⼜该如何处理客户端的请求呢？通常来讲，有三种处理⽅式。

#### 同步阻塞⽅式

    客户端每发⼀次请求，服务端就⽣成⼀个线程去处理。当客户端同时发起的请求很多时，服务端需要创建很多的线程去处理每⼀个请求，如果达到了系统最⼤的
    线程数瓶颈，新来的请求就没法处理了。
    
    BIO适⽤于连接数⽐较⼩的业务场景，这样的话不⾄于系统中没有可⽤线程去处理请求。这种⽅式写的程序也⽐较简单直观，易于理解。

    
#### 同步⾮阻塞⽅式 

    客户端每发⼀次请求，服务端并不是每次都创建⼀个新线程来处理，⽽是通过I/O多路复⽤技术进⾏处理。就是把多个I/O的阻塞复⽤到同⼀个select的阻塞上，从
    ⽽使系统在单线程的情况下可以同时处理多个客户端请求。这种⽅式的优势是开销⼩，不⽤为每个请求创建⼀个线程，可以节省系统开销。
    
    NIO适⽤于连接数⽐较多并且请求消耗⽐较轻的业务场景，⽐如聊天服务器。这种⽅式相⽐BIO，相对来说编程⽐较复杂。
    
#### 异步⾮阻塞⽅式

    客户端只需要发起⼀个I/O操作然后⽴即返回，等I/O操作真正完成以后，客户端会得到I/O操作完成的通知，此时客户端只需要对数据进⾏处理就好了，不需要进
    ⾏实际的I/O读写操作，因为真正的I/O读取或者写⼊操作已经由内核完成了。这种⽅式的优势是客户端⽆需等待，不存在阻塞等待问题

    AIO适⽤于连接数⽐较多⽽且请求消耗⽐较重的业务场景，⽐如涉及I/O操作的相册服务器。这种⽅式相⽐另外两种，编程难度最⼤，程序也不易于理解。

#### Netty


## 通信胁议
### 数据传输采⽤什么协议
    
    就是说服务提供者和服务消费者之间的数据传输采⽤哪种⽅式，是同步还是异步，是在单连接上传输，还是多路复⽤。

#### HTTP数据传输协议

#### Dubbo数据传输协议
    

## 序列化和反序列化
### 数据该如何序列化和反序列化

    ⼀般数据在⽹络中进⾏传输前，都要先在发送⽅⼀端对数据进⾏编码，经过⽹络传输到达另⼀端后，再对数据进⾏解码，这个过程就是序列化和反序列化

常⽤的序列化⽅式分为两类：⽂本类如XML/JSON等，⼆进制类如PB/Thrift等

#### ⽂本类如XMLJSON等

#### ⼆进制类如PBThrift



### 数据压缩采⽤什么格式

    通常数据传输都会对数据进⾏压缩，来减少⽹络传输的数据量，从⽽减少带宽消耗和⽹络传输时间，⽐如常⻅的JSON序列化、Java对象序列化以及Protobuf序列化等。


### RPC框架如何选型

主要分为两类：⼀类是跟某种特定语⾔平台绑定的，另⼀类是与语⾔⽆关即跨语⾔平台的。

#### 跟某种特定语⾔平台绑定的

    仔细分析，可以看出Spring Cloud不仅提供了基本的RPC框架功能，还提供了服务注册组件、配置中⼼组件、负载均衡组件、断路器组件、分布式消息追踪组件等
    ⼀系列组件，也难怪被技术圈的⼈称之为“Spring Cloud全家桶”。如果你不想⾃⼰实现以上这些功能，那么Spring Cloud基本可以满⾜你的全部需求。⽽Dubbo
    Motan基本上只提供了最基础的RPC框架的功能，其他微服务组件都需要⾃⼰去实现。

##### Dubbo
##### Spring Cloud
##### Monta
##### Tars



#### 跨语⾔平台

    gRPC作为后起之秀，因为采⽤了HTTP/2作为通信协议、ProtoBuf作为数据序列化格式，在移动端设备的应⽤以及对传输带宽⽐较敏感的场景下具有很⼤的优
    势，⽽且开发⽂档丰富，根据ProtoBuf⽂件⽣成的代码要⽐Thrift更简洁⼀些，从使⽤难易程度上更占优势，所以如果使⽤的语⾔平台gRPC⽀持的话，建议还
    是采⽤gRPC⽐较好。

##### gRPC

##### Thrift
    
    
    

    
    
    
